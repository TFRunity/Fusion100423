@model List<Category>
@inject UserManager<User> _userManager
@{ 
    bool authentificated = User.Identity.IsAuthenticated;
    User _user = new User();
    if(authentificated == true)
    {
        User user = await _userManager.FindByNameAsync(User.Identity.Name);
        _user = user;
        OrderNavbarViewModel viewModel = new OrderNavbarViewModel() { Authentificated = true, OrderId = _user.CurrentOrderId };
        await Html.RenderPartialAsync("_Navbar", viewModel);
    }
    else
    {
        OrderNavbarViewModel viewModel = new OrderNavbarViewModel() { Authentificated = false };
        await Html.RenderPartialAsync("_Navbar", viewModel );
    }
}
@{await Html.RenderPartialAsync("_Carousel"); }

@{
    if (Model != null)
    {
        <main class="container">
            @foreach (Category category in Model)
            {
                <article class="article-title" id="@category.Name">
                    <h2>@category.Fullname</h2>
                </article>
                <section class="row flex--wrap justify-content-sm-center">
                    @foreach (ProductCategory product in category.ProductCategories)
                    {
                    <div class="col-3 block-product justify-content-sm-center text-center">
                        <div class="justify-content-sm-center m-3">
                            @{
                                if (product.Product.Url != null)
                                {
                                    <img src="@product.Product.Url" class="img-fluid align-self-center anim" style="border-radius: 15px;" />
                                }
                                else
                                {
                                    <img src="assets/img/logo.jpg" class="img-fluid align-self-center anim" style="border-radius: 15px;" />
                                }
                            }
                        </div>
                        <h3 class="text-start">
                            @product.Product.Name
                        </h3>
                        <div class="p-1">
                            <h6 class="text-start" style="color: rgb(137 143 180);">
                                @product.Product.Description
                            </h6>
                        </div>
                        <div class="row">
                            <h4 class="col-5 text-start p-1 m-2">
                                @product.Product.Price ₽
                            </h4>
                            @{
                                if (authentificated)
                                {
                                    <a class="btn btn-primary btn-sm col-6 p-2 text-center align-self-center" href="@Url.Action("Cart","Account", new { UserEmail = _user.Email, ProductId = product.ProductId })" style="background-color: orange; border-radius: 10px; border-color: red;" role="button">В корзину</a>
                                }
                                else
                                {
                                    <a class="btn btn-primary btn-sm col-6 p-2 text-center align-self-center" href="@Url.Action("Login","Account")">В корзину</a>
                                }
                            }
                            
                        </div>
                    </div>
                    }
                </section>
                <div class="b-example-divider"></div>
            }
        </main>
    }
}
<div class="container">
    <footer class="py-3 my-4">
        <p class="text-center text-body-secondary">© 2023 Company, Inc</p>
    </footer>
</div>